import{open as ee}from"node:fs/promises";var p=process.cwd();var te={arrowParens:"arrow-parens",bracketSpacing:"block-spacing",endOfLine:"linebreak-style",quoteProps:"quote-props",semi:"semi",singleQuote:"quotes",trailingComma:"comma-dangle"},re=new Set(["block-spacing","comma-dangle","quotes","quote-props"]),ne={printWidth:"code",tabWidth:"tabWidth"},ie=new Set(["printWidth","tabWidth"]),oe=new Set(["avoid","false","none","preserve"]),se=new Set(["plugins","bracketSameLine","parser","editorconfig","embeddedLanguageFormatting","experimentalTernaries","jsxBracketSameLine","jsxSingleQuote","singleAttributePerLine","useTabs","vueIndentScriptAndStyle","htmlWhitespaceSensitivity","proseWrap","insertPragma","requirePragma","filepath","rangeStart","rangeEnd"]),I="@stylistic/js",ae="@stylistic/ts",B=`${I}/max-len`;function le(e,t,r){let n=e[B];n||(n=e[B]=[2,{}]),n[1][ne[t]]=r}function fe(e,t,r,n){switch(r){case"semi":e["@stylistic/ts/member-delimiter-style"]=[2,{multiline:{delimiter:n?"none":"semi"},singleline:{delimiter:"semi",requireLast:!1}}];break}}function pe(e,t,r){typeof r=="boolean"&&(r=`${r}`);let n=oe.has(r),i=te[t],o=re.has(i)?ae:I,s=0;switch(i){case"block-spacing":s=[2,n?"never":"always"],e[`${o}/object-curly-spacing`]=s;break;case"arrow-parens":case"quote-props":s=n?0:[2,r];break;case"semi":s=[2,n?"never":"always"];break;case"quotes":s=[2,n?"double":"single",{avoidEscape:!0}];break;case"comma-dangle":s=n?[2,"never"]:[2,r==="all"?"always":"only-multiline"];break;case"linebreak-style":s=[2,r==="lf"?"unix":"windows"];break;default:throw new Error(`Unknown prettier option ${t}.`)}e[`${o}/${i}`]=s,fe(e,o,i,n)}async function w(){let e,t={};try{e=await ee(`${p}/.prettierrc`,"r")}catch{return{name:"prettier-apply",rules:[]}}let r=JSON.parse((await e.readFile()).toString());for(let n of Object.keys(r))se.has(n)||(ie.has(n)?le(t,n,r[n]):pe(t,n,r[n]));return await e.close(),{name:"prettier-apply",rules:[t]}}import{fdir as ce}from"fdir";async function L(){let t=await new ce().withFullPaths().withMaxDepth(1).crawl(p).withPromise(),r=t.length,n=[],i;for(let o=0;o<r;o++)i=t[o],i.includes("tsconfig")&&i.includes("json")&&n.push(i);return{languageOptions:{parserOptions:{project:n}}}}import{open as ge}from"node:fs/promises";async function O(e){let t,r=[];try{t=await ge(`${p}/${e}`,"r")}catch{return{name:`parse-${e}`,ignores:r}}for await(let n of t.readLines())!n.length||n[0]==="#"||(n[0]==="*"&&n[1]==="."?r.push(n,`**/${n}`):r.push(n,n[0]==="!"||n[0]==="/"?`${n}/**`:`**/${n}/**`));return await t.close(),{name:`parse-${e}`,ignores:[...new Set(r)]}}import{dirname as Pe}from"node:path";import{fileURLToPath as he}from"node:url";var ue=new Set(["angular","web","cypress","format","fp","jest","json","node","react","base","test-base","test-angular","test-web","test-react","test-vue","tsdoc","vitest","vue"]);function S(e){return ue.has(e)}function c(e){return e?Array.isArray(e)?e.slice():[e]:[]}function u(e,t){return Array.prototype.push.apply(e,t),e}function m(e){for(let t in e)return!1;return!0}function me(e,t){return[...new Set((e??[]).slice().concat(t??[]))]}function k(e,t,r,n=[]){let i=[...new Set(Object.keys(e).concat(Object.keys(t)))],o,s,a;for(let l of i)n.includes(l)||(r.includes(l)?e[l]=t[l]??e[l]:(o=e[l],s=t[l],Array.isArray(o)?a=me(o,s):typeof o=="object"&&o!==null?a=Object.assign({},o,s):a=s??o,e[l]=a))}function de(e,t){if(!t.languageOptions){e.languageOptions=e.languageOptions??{};return}let r=t.languageOptions,n=e.languageOptions=e.languageOptions??{};if(k(n,r,["parser"],["parserOptions"]),!r.parserOptions){n.parserOptions=n.parserOptions??{};return}k(n.parserOptions,r.parserOptions,["parser"])}function ye(e){let t=Object.keys(e);for(let r of t)(Array.isArray(e[r])&&!e[r].length||m(e[r]))&&delete e[r]}function y(e,t){let r=Object.assign({},e);return de(r,t),k(r,t,["name"],["extends","languageOptions"]),ye(r),r}var C=new Map;async function N(e){if(C.has(e))return C.get(e);let t=await import(`file://${Pe(he(import.meta.url))}/profiles/${e}.js`);return C.set(e,t.config),t.default??t.config}function be(e){let t={};return e.parserOptions?t={parserOptions:e.parserOptions}:e.languageOptions&&(t=e.languageOptions),{files:e.files,ignores:e.ignores,languageOptions:t,linterOptions:e.linterOptions,name:"extended-file",plugins:e.plugins,processor:e.processor?c(e.processor):void 0,rules:c(e.rules),settings:e.settings}}async function xe(e,t){let r;if(typeof e=="string"&&S(e))if(C.has(e))r=C.get(e);else{let n=await N(e);Array.isArray(n)?(r=n.shift(),u(t,n)):r=n}else typeof e!="string"&&(r=be(e));return r}async function H(e,t){if(!e.extends)return e;let r=e.extends.length,n=e,i;for(let o=0;o<r;o++)i=await xe(e.extends[o],t),i&&(i.extends&&(i=await H(i,t)),n=y(i,n),i=void 0);return n}async function Ce(e){if(!e.length)return[];let t=[];for(let r=0;r<e.length;r++)t.push(await H(e[r],e));return t}async function j(e){let t=e.configs,r=t.length,n=new Array(r);for(let o=0;o<r;o++)n[o]=N(t[o]);let i=await Promise.all(n);return await Ce(i.flat())}function v(e,t){let r=t.length;if(!r||!e.length)return e.slice();let n;for(let i=0;i<r;i++)if(n=e.indexOf(t[i]),n>-1&&e.splice(n,1),!e.length)return[];return e.slice()}var we=["brace-style","no-extra-parens","object-curly-spacing","quote-props"];var J=[...we,"arrow-parens","indent","semi","quotes","lines-around-comment","padding-line-between-statements","space-before-function-paren"],U=["class-methods-use-this","consistent-return","dot-notation","default-param-last","no-array-constructor","no-loop-func","no-loss-of-precision","no-redeclare","no-throw-literal","no-unused-vars","no-unused-expressions","no-use-before-define","no-useless-constructor","require-await"],T=["comma-spacing","func-call-spacing","key-spacing","keyword-spacing","lines-between-class-members","no-extra-semi","space-before-blocks","space-infix-ops"],Q=["type-annotation-spacing"],pt=[...v(T,["lines-between-class-members","no-extra-semi","space-before-blocks"]),"block-spacing","func-call-spacing"],z=["arrow-spacing","eol-last","no-trailing-spaces","space-in-parens"];function d(...e){return Object.assign({},...e)}var P="?([cm])[jt]s?(x)";var K=`**/*${P}`,ut=[`**/__tests__/**/*.${P}`,`**/*.spec.${P}`,`**/*.test.${P}`,`**/*.bench.${P}`,`**/*.benchmark.${P}`];function F(e){return!!e.configs.recommended}function A(e){let t=Object.keys(e),r=t.length,n={plugins:{},rules:{}},i,o;for(let s=0;s<r;s++)i=t[s],o=e[i],n.plugins[i]=o,F(o)&&(n.rules=Object.assign(n.rules,o.configs.recommended.rules));return n}function $(e){return Object.hasOwn(e,"rules")||Object.hasOwn(e,"plugins")}function R(...e){let t=e.length,r=new Array(t),n;for(let i=t-1;i>=0;i--)n=e[i],r[i]=$(n)?n.rules:n;return d(...r)}function h(e,t){return e==="eslint"?t:`${e}/${t}`}function E(e,t){let r=e.length,n=t.length,i={},o,s;for(let a=0;a<n;a++)for(o=t[a],s=0;s<r;s++)i[h(o,e[s])]=0;return i}function b(e,t,r){let n=e.length,i=t.length,o=r.length,s={},a,l;for(let f=0;f<n;f++){for(a=e[f],l=0;l<i;l++)s[h(t[l],a)]=0;for(l=0;l<o;l++)s[h(r[l],a)]=2}return s}function q(e){let t=new Map,r=e.length,n=`merged-processor:${e[0].meta?.name??"unknown"}`;for(let i=1;i<r;i++)n=`${n}+${e[i].meta?.name??"unknown"}`;return{meta:{name:n},postprocess(i,o){let s=t.get(o),a=[];t.delete(o);let l=0,f;for(let x=0;x<r;x++)f=i.slice(l,l+s[x]),l+=s[x],u(a,e[x].postprocess?.(f,o)??[]);return a},preprocess(i,o){let s=new Array(r),a=[];t.set(o,s);let l;for(let f=0;f<r;f++)l=e[f].preprocess?.(i,o)??[],s[f]=l.length,u(a,l);return a},supportsAutofix:!0}}function Le(e){let t=e.languageOptions;if(!t||m(t))return!0;if(t.parserOptions){let r=t.parserOptions;return m(r)?!0:r.project&&!r.project.length}return m(t.globals)}function Oe(){return[E(J,["eslint","@typescript-eslint","@stylistic/ts"]),b(U,["eslint"],["@typescript-eslint"]),b(T,["eslint","@typescript-eslint"],["@stylistic/ts"]),b(z,["eslint"],["@stylistic/js"]),b(Q,["@typescript-eslint"],["@stylistic/ts"])]}function X(e,t,r,n,i,o){let s=t[n];s?.length?e[n]=s:i?e[n]=r[0][n]??o:e[n]=o}var Re=[K],Se=[];function G(e,t){let r=e.length,n=new Array(r),i,o,s;for(let a=0;a<r;a++)i=e[a],o=i.apply?A(i.apply):{},X(o,i,e,"files",t,Re),X(o,i,e,"ignores",t,Se),i.languageOptions&&(s=o.languageOptions=i.languageOptions,s.globals=d(...c(i.languageOptions.globals))),Le(o)&&delete o.languageOptions,i.linterOptions&&(o.linterOptions=i.linterOptions),i.settings&&(o.settings=i.settings),i.processor&&(o.processor=q(i.processor)),o.plugins=d(o.plugins??{},i.plugins??{}),o.rules=R(o.rules??{},...i.rules??[]),t&&a===0&&(o.rules=R(o.rules,...Oe())),n[a]=o;return n}var ke=new Set(["base","fp","react","vue","angular","node","test-base","test-angular","test-react","test-vue","test-web"]);function M(e){let t=!1;for(let r=e.configs.length-1;r>=0;r--)if(ke.has(e.configs[r])){t=!0;break}return t}import{existsSync as Y}from"fs";import{mkdir as je,open as ve,writeFile as Te}from"fs/promises";var V={"eslint.experimental.useFlatConfig":!0,"editor.codeActionsOnSave":{"source.fixAll.eslint":"explicit"},"eslint.rules.customizations":[{rule:"style/*",severity:"off"},{rule:"format/*",severity:"off"},{rule:"*-indent",severity:"off"},{rule:"*-spacing",severity:"off"},{rule:"*-spaces",severity:"off"},{rule:"*-order",severity:"off"},{rule:"*-dangle",severity:"off"},{rule:"*-newline",severity:"off"},{rule:"*quotes",severity:"off"},{rule:"*semi",severity:"off"}],"eslint.validate":["javascript","javascriptreact","typescript","typescriptreact","vue","html","markdown","json","jsonc","yaml","toml","astro"]},Fe=Object.keys(V);async function D(){let e=`${p}/.vscode`,t=`${e}/settings.json`;Y(e)||await je(e),Y(t)||await Te(t,JSON.stringify(V),"utf8");let r=await ve(t,"r+"),n=JSON.parse((await r.readFile()).toString()),i=!0;for(let o of Fe)if(n[o]){i=!1;break}i&&await r.writeFile(JSON.stringify(Object.assign(n,V))),await r.close()}import Ae from"ora";import*as g from"yoctocolors";var W=[g.yellow("Fetching configs..."),g.cyan("Applying plugins..."),g.blueBright("Parsing profiles...")],Z=["yellow","cyan","blue"];function*_(){let e=Date.now(),t=Ae(W[0]);t.color=Z[0],t.start(),yield;let r=W.length,n;for(n=1;n<r;n++)t.succeed(),t.color=Z[n],t.text=W[n],t.start(),yield;t.color="green",t.text=g.greenBright(`Ready to lint after ${Date.now()-e}ms!`),t.succeed()}var $e={configs:["base"],ignoreFiles:[".eslintignore, .gitignore"],prettier:!0,patchVSCode:!0};async function Ee(e){let t=Date.now(),r=Object.assign({},$e,e);if(!r.configs.length)return[];let n=_();n.next();let i=M(r),o=[j(r),L()];if(i&&r.prettier&&o.push(w()),r.ignoreFiles.length)for(let f=r.ignoreFiles.length-1;f>=0;f--)o.push(O(r.ignoreFiles[f]));r.patchVSCode&&o.push(D());let s=await Promise.all(o);n.next();let a=s.shift();a.unshift(y(a.shift(),...c(s))),n.next();let l=G(a,i);return n.next(),l}export{Ee as default,d as merge,u as mergeArr};
//# sourceMappingURL=index.js.map
